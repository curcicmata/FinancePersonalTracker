# version: '3.9'

# services:
#   web:
#     build:
#       context: .
#       dockerfile: FinancePersonalTracker/Dockerfile
#     ports:
#         - "5000:8080"
#         - "5001:8081"
#     environment:
#       - ASPNETCORE_ENVIRONMENT=Development
#       - ASPNETCORE_URLS=http://+:80   # tells Kestrel to listen on port 80
#       - ConnectionStrings__DefaultConnection=Host=db;Port=5432;Database=FinancePersonalTracker;Username=appuser;Password=StrongAppPassword!
#     depends_on:
#       - db
#     restart: unless-stopped

#   db:
#     image: postgres:18
#     environment:
#       POSTGRES_USER: appuser
#       POSTGRES_PASSWORD: StrongAppPassword!
#       POSTGRES_DB: FinancePersonalTracker
#     ports:
#       - "5433:5432"  # host access for testing: localhost:5433
#     volumes:
#       - pgdata:/var/lib/postgresql
#     restart: unless-stopped

# volumes:
#   pgdata:

version: '3.9'

services:
  web:
    build:
      context: .
      dockerfile: FinancePersonalTracker/Dockerfile
    ports:
      - "5000:80"
    environment:
      ASPNETCORE_ENVIRONMENT: Development
      ConnectionStrings__DefaultConnection: Host=db;Port=5432;Database=FinancePersonalTracker;Username=appuser;Password=StrongAppPassword!
    depends_on:
      - db
    restart: unless-stopped

  db:
    image: postgres:16
    environment:
      POSTGRES_USER: appuser
      POSTGRES_PASSWORD: StrongAppPassword!
      POSTGRES_DB: FinancePersonalTracker
    ports:
      - "5433:5432"
    volumes:
      - pgdata:/var/lib/postgresql/data
    restart: unless-stopped

volumes:
  pgdata:

